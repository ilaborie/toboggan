#!/usr/bin/env bash
#MISE description="Run clippy linting with strict warnings as errors"

set -eux

# Rust linting
cargo clippy --all-targets --all-features -- -D warnings

# Swift linting
if command -v swiftlint >/dev/null 2>&1; then
    echo "Linting Swift code with SwiftLint..."
    if [ -d "toboggan-ios/TobogganApp" ]; then
        if swiftlint lint toboggan-ios/TobogganApp --config .swiftlint.yml 2>/dev/null; then
            echo "SwiftLint check completed successfully"
        else
            echo "SwiftLint check failed or SourceKit unavailable, skipping Swift linting"
            echo "Note: This may happen in CI environments or when Xcode tools are not properly configured"
        fi
    else
        echo "No Swift code found in toboggan-ios/TobogganApp, skipping SwiftLint"
    fi
else
    echo "SwiftLint not found, skipping Swift linting (install with: mise install swiftlint)"
fi
